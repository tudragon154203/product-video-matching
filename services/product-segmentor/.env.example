# Product Segmentor Service Configuration

# Segmentation Model Configuration
FOREGROUND_SEG_MODEL_NAME=briaai/RMBG-2.0
PEOPLE_SEG_MODEL_NAME=yolo11l-seg
HF_TOKEN=hf_xxx_your_personal_access_token # only needed for gated-repo
# Note: PEOPLE_SEG_MODEL_CACHE is retired - now using global MODEL_CACHE

# Processing Configuration
BATCH_TIMEOUT_SECONDS=1800
MASK_QUALITY=0.8

# Processing Configuration
# MAX_CONCURRENT_IMAGES_IN_BATCH: Images processed concurrently within a single batch
#   - Controls parallelism INSIDE each video/product batch
#   - 8GB GPU: 2-3, 16GB GPU: 4-5, 24GB GPU: 8-10
MAX_CONCURRENT_IMAGES_IN_BATCH=3
MIN_CONCURRENT_IMAGES_IN_BATCH=1

# MAX_CONCURRENT_BATCHES: Number of RabbitMQ batch messages processed concurrently
#   - Controls how many video batches can be in-flight at once
#   - Lower = less GPU memory, higher = better throughput
#   - Recommended: 2-3 for 8GB GPU, 4-5 for 16GB GPU
MAX_CONCURRENT_BATCHES=2

# GPU Memory Management
# Boolean values accept: 1, true, yes, enable (case-insensitive)
USE_FP16=true  # Use FP16 (half precision) to reduce GPU memory usage by ~50%
RETRY_ON_OOM=true  # Enable automatic retry on CUDA out-of-memory errors
MAX_OOM_RETRIES=3  # Number of retry attempts with exponential backoff
GPU_MEMORY_THRESHOLD=0.85  # Block new tasks when GPU memory exceeds 85%

# File Paths relative to DATA_ROOT
FOREGROUND_MASK_REL_PATH=./masks_foreground
PEOPLE_MASK_REL_PATH=./masks_people
PRODUCT_MASK_REL_PATH=./masks_product

LOG_LEVEL=INFO
